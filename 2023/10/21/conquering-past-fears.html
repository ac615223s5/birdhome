<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Conquering Past Fears | Birdhome</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Conquering Past Fears" />
<meta name="author" content="nieve" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="With my training nearing completion, I decided to revisit a few past problems I had failed on and find some catharsis." />
<meta property="og:description" content="With my training nearing completion, I decided to revisit a few past problems I had failed on and find some catharsis." />
<link rel="canonical" href="https://birdhome.stellar.afs.ovh/2023/10/21/conquering-past-fears.html" />
<meta property="og:url" content="https://birdhome.stellar.afs.ovh/2023/10/21/conquering-past-fears.html" />
<meta property="og:site_name" content="Birdhome" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-10-21T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Conquering Past Fears" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"nieve"},"dateModified":"2023-10-21T00:00:00+00:00","datePublished":"2023-10-21T00:00:00+00:00","description":"With my training nearing completion, I decided to revisit a few past problems I had failed on and find some catharsis.","headline":"Conquering Past Fears","mainEntityOfPage":{"@type":"WebPage","@id":"https://birdhome.stellar.afs.ovh/2023/10/21/conquering-past-fears.html"},"url":"https://birdhome.stellar.afs.ovh/2023/10/21/conquering-past-fears.html"}</script>
<!-- End Jekyll SEO tag -->
<link type="application/atom+xml" rel="alternate" href="https://birdhome.stellar.afs.ovh/feed.xml" title="Birdhome" /><link rel="stylesheet" href=/assets/css/main.css type="text/css">
  <script src="//unpkg.com/alpinejs" defer></script> 
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body class="flex flex-col">
  <div class="absolute -z-10 w-1/6 right-0 top-0">
    <img src="" class="dark:hidden ">
<img src="/assets/images/decorations/christmas/03eb2460745a2a7adf50c3a45985c3be-818976456-right.webp" class="hidden dark:block ">
  </div>
  <div class="absolute -z-10 w-1/6 left-0 top-0">
    <img src="" class="dark:hidden ">
<img src="/assets/images/decorations/christmas/03eb2460745a2a7adf50c3a45985c3be-818976456-left.webp" class="hidden dark:block ">
  </div>
  <div class="grow">
    <div class="flex max-lg:flex-col flex-row gap-2.5 justify-center">
      <div class="container1">
<header class="site-header  w-44 max-lg:w-full lg:h-full"><nav class="site-nav z-20 flex flex-col gap-3 max-lg:flex-row max-lg:justify-between h-full">
    <a class="text-2xl dark:text-amber-400" rel="author" href="/">Birdhome</a>
    <input type="checkbox" id="nav-trigger" class="hidden" />
    <label for="nav-trigger" class="sm:hidden">
      <span class="menu-icon">
        <svg viewBox="0 0 18 15" width="18px" height="15px">
          <path
            d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z" />
        </svg>
      </span>
    </label>
    <div class="trigger flex flex-col max-lg:flex-row max-lg:gap-4 max-lg:flex-wrap max-sm:hidden max-sm:flex-col max-sm:absolute right-3 top-10"><a class="text-lg header" href="/blog">Blog</a><a class="text-lg header" href="/lookout">Map</a><a class="text-lg header" href="/credits">Credits</a><a class="text-lg header" href="/images">Images</a><a class="text-lg header" href="/coding">Coding</a><a class="text-lg header" href="/art">Art</a><a class="text-lg header" href="/algorithm">Algorithm</a><a class="text-lg header" href="/music">Music</a></div><div class="max-lg:hidden grow"></div>
    <div class="max-lg:hidden">
      <img src="/assets/images/decorations/christmas/transparent-snowflakes-tumblr-3.png" class="dark:hidden ">
<img src="/assets/images/decorations/christmas/BcaE88bXi-365092411.png" class="hidden dark:block ">
      
    </div>
  </nav></header>
<style>
  .site-nav input:checked~.trigger{
    display:flex;
  }
</style></div>
      <main class="grow max-w-screen-sm container1 mainStyle z-10" aria-label="Content">
  <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header mb-7">
    <h1 class="post-title p-name" itemprop="name headline">Conquering Past Fears</h1>
    <p class="post-meta text-sm textColor2">
          <a href="/blog#tag-writeup">writeup</a>
        |<time class="dt-published" datetime="2023-10-21T00:00:00+00:00" itemprop="datePublished">
        21 Oct, 2023
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">nieve</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>With my training nearing completion, I decided to revisit a few past problems I had failed on and find some catharsis.</p>

<h2 id="contents">Contents</h2>

<ol>
  <li><a href="#canadian-computing-competition-2019-s3---arithmetic-square">ccc2019s3 arithmetic square</a></li>
  <li><a href="#canadian-computing-competition-2019-s4---tourism">ccc2019s4 tourism</a></li>
  <li><a href="#olympiads-computing-competition">olympiads computing competition</a></li>
  <li><a href="#codeforces-global-9-i-1375i---cubic-lattice">codeforce1375i cubic lattice</a></li>
  <li><a href="#canadian-computing-olympiad-day-2">cco2021 day 2</a></li>
  <li><a href="#conclusion">conclusion</a></li>
</ol>

<h2 id="canadian-computing-competition-2019-s3---arithmetic-square">Canadian Computing Competition 2019 S3 - Arithmetic Square</h2>

<p><a href="https://dmoj.ca/problem/ccc19s3">Link</a></p>

<p>Doing well on the CCC was a big deal for me back in 2019, so I remember this problem well as my hopes of advancing to the next round were slowly destroyed over 3 long hours. I remember randomly filling in empty squares before realizing that this could lead to an inconsistent set of equations, then getting stuck on some cases with 3 elements filled in. Then Bruce showed me a clever order for filling them in that somehow magically solved it. Lets take another look at this problem…</p>

<p>There are definitely quite a few cases, but I don’t think any of them are that hard to solve. It would probably actually be faster to just write the code than explain everything in words. Another solution is to just write the system of equations and use elimination or something.</p>

<h2 id="canadian-computing-competition-2019-s4---tourism">Canadian Computing Competition 2019 S4 - Tourism</h2>

<p><a href="https://dmoj.ca/problem/ccc19s4">Link</a></p>

<p>This problem was difficult compared to previous CCC problems and also contributed to my poor performance in 2019. After upsolving this problem, I was worried about whether I would be able to solve another problem like this, and in fact even in 2020 I did not expect to solve S4 despite my improvement over the last year. Eventually some new test case got added that made almost everyone’s solution get wrong answer, so maybe the problem is even harder. We’ll see.</p>

<p>The first thing I noticed was there were many accepted solutions despite the extra tests. Anyway, I know my solution used monotonic dp transition or something, but can’t you just use a segment tree to find the best location to travel from? With a monostack for previous maximums of course. I’ll write a code to see if it works. And… it got AC. Nice.</p>

<details>
    <summary>Code</summary>
    
<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ext/pb_ds/assoc_container.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ext/pb_ds/tree_policy.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ext/pb_ds/priority_queue.hpp&gt;</span><span class="cp">
#ifndef LOCAL</span><span class="cm">/*
    #pragma GCC optimize("Ofast")
    #pragma GCC optimize "unroll-loops"
    #pragma GCC target "mmx,sse,sse2,sse3,sse4,avx,avx2,fma,abm,popcnt,tune=native" //*/</span><span class="cp">
</span>    <span class="c1">//#pragma GCC optimize "prefetch-loop-arrays"</span>
<span class="cp">#endif // LOCAL
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span> <span class="k">using</span> <span class="k">namespace</span> <span class="n">__gnu_pbds</span><span class="p">;</span>
<span class="cp">#define foru(i,a,b) for(ll i=(a);i&lt;(b);i++)
#define ford(i,a,b) for(ll i=(a)-1;i&gt;=(b);i--)
#define fori(a,b) foru(i,a,b)
#define forj(a,b) foru(j,a,b)
#define fork(a,b) foru(k,a,b)
#define seto(x,i) memset(x,i,sizeof x)
#define pf first
#define ps second
#define pb push_back
#define eb emplace_back
#define em emplace
#define mp make_pair
#define mt make_tuple
#define popcount __builtin_popcount
#define popcountll __builtin_popcountll
#define clz __builtin_clz
#define clzll __builtin_clzll
#define ctz __builtin_ctz
#define ctzll __builtin_ctzll
#define P2(x) (1LL&lt;&lt;(x))
#define sz(x) (ll)x.size()
#define all(x) begin(x),end(x)
#define lwb lower_bound
#define upb upper_bound
#if __SIZEOF_INT128__
</span>    <span class="k">typedef</span> <span class="n">__int128_t</span> <span class="n">i128</span><span class="p">;</span> <span class="k">typedef</span> <span class="n">__uint128_t</span> <span class="n">ui128</span><span class="p">;</span>
<span class="cp">#endif
</span><span class="k">typedef</span> <span class="kt">int64_t</span> <span class="n">ll</span><span class="p">;</span>  <span class="k">typedef</span> <span class="kt">uint64_t</span> <span class="n">ull</span><span class="p">;</span> <span class="k">typedef</span> <span class="kt">long</span> <span class="kt">double</span> <span class="n">lld</span><span class="p">;</span> <span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">pii</span><span class="p">;</span> <span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">pll</span><span class="p">;</span> <span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">lld</span><span class="p">,</span><span class="n">lld</span><span class="o">&gt;</span> <span class="n">pdd</span><span class="p">;</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">&gt;</span> <span class="k">using</span> <span class="n">ordered_map</span><span class="o">=</span><span class="n">tree</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">,</span><span class="n">less</span><span class="o">&lt;</span><span class="n">T1</span><span class="o">&gt;</span><span class="p">,</span><span class="n">rb_tree_tag</span><span class="p">,</span><span class="n">tree_order_statistics_node_update</span><span class="o">&gt;</span><span class="p">;</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">&gt;</span> <span class="k">using</span> <span class="n">ordered_set</span><span class="o">=</span><span class="n">ordered_map</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">null_type</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="k">using</span> <span class="n">minpq</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="n">greater</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">;</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="k">using</span> <span class="n">maxpq</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="n">less</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">;</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="k">using</span> <span class="n">minpairingheap</span><span class="o">=</span><span class="n">__gnu_pbds</span><span class="o">::</span><span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">greater</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="n">pairing_heap_tag</span><span class="o">&gt;</span><span class="p">;</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span><span class="k">using</span> <span class="n">maxpairingheap</span><span class="o">=</span><span class="n">__gnu_pbds</span><span class="o">::</span><span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">less</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="n">pairing_heap_tag</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">inf</span><span class="o">=</span><span class="mh">0x3f3f3f3f</span><span class="p">,</span><span class="n">MOD</span><span class="o">=</span><span class="mf">1e9</span><span class="o">+</span><span class="mi">7</span><span class="p">;</span> <span class="k">const</span> <span class="n">ll</span> <span class="n">INF</span><span class="o">=</span><span class="mh">0x3f3f3f3f3f3f3f3f</span><span class="p">;</span> <span class="k">const</span> <span class="n">lld</span> <span class="n">PI</span><span class="o">=</span><span class="n">acos</span><span class="p">((</span><span class="n">lld</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">SEED</span><span class="o">=</span><span class="mi">443214</span><span class="o">^</span><span class="n">chrono</span><span class="o">::</span><span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">chrono</span><span class="o">::</span><span class="n">nanoseconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">chrono</span><span class="o">::</span><span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">().</span><span class="n">time_since_epoch</span><span class="p">()).</span><span class="n">count</span><span class="p">();</span>
<span class="n">mt19937</span> <span class="nf">randgen</span><span class="p">(</span><span class="n">SEED</span><span class="p">);</span> <span class="n">ll</span> <span class="nf">rand</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">uniform_int_distribution</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)(</span><span class="n">randgen</span><span class="p">);}</span>
<span class="n">ll</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">b</span><span class="o">?</span><span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">)</span><span class="o">:</span><span class="n">a</span><span class="p">;}</span>
<span class="n">ll</span> <span class="nf">fpow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">){</span><span class="n">ll</span> <span class="n">ret</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span> <span class="n">ret</span><span class="o">=</span><span class="n">ret</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">MOD</span><span class="p">;}</span><span class="k">return</span> <span class="n">ret</span><span class="p">;}</span> <span class="n">ll</span> <span class="nf">fpow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">,</span><span class="n">ll</span> <span class="n">M</span><span class="p">){</span><span class="n">ll</span> <span class="n">ret</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span> <span class="n">ret</span><span class="o">=</span><span class="n">ret</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">M</span><span class="p">;</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">M</span><span class="p">;}</span><span class="k">return</span> <span class="n">ret</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span> <span class="nf">_min</span><span class="p">(</span><span class="k">const</span> <span class="n">T1</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">T2</span><span class="o">&amp;</span><span class="n">y</span><span class="p">){</span><span class="k">return</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">y</span><span class="o">?</span><span class="n">x</span><span class="o">:</span><span class="n">y</span><span class="p">;}</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="k">class</span><span class="o">...</span><span class="nc">Ts</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="k">auto</span> <span class="nf">_min</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">Ts</span><span class="o">&amp;</span><span class="p">...</span><span class="n">xs</span><span class="p">){</span><span class="k">return</span> <span class="n">_min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">_min</span><span class="p">(</span><span class="n">xs</span><span class="p">...));}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span> <span class="nf">_max</span><span class="p">(</span><span class="k">const</span> <span class="n">T1</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">T2</span><span class="o">&amp;</span><span class="n">y</span><span class="p">){</span><span class="k">return</span> <span class="n">x</span><span class="o">&gt;</span><span class="n">y</span><span class="o">?</span><span class="n">x</span><span class="o">:</span><span class="n">y</span><span class="p">;}</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="k">class</span><span class="o">...</span><span class="nc">Ts</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="k">auto</span> <span class="nf">_max</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">Ts</span><span class="o">&amp;</span><span class="p">...</span><span class="n">xs</span><span class="p">){</span><span class="k">return</span> <span class="n">_max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">_max</span><span class="p">(</span><span class="n">xs</span><span class="p">...));}</span>
<span class="cp">#define min(...) _min(__VA_ARGS__)
#define max(...) _max(__VA_ARGS__)
</span><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="kt">bool</span> <span class="nf">ckmin</span><span class="p">(</span><span class="n">T1</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">T2</span><span class="o">&amp;</span><span class="n">y</span><span class="p">){</span><span class="k">return</span> <span class="n">x</span><span class="o">&gt;</span><span class="n">y</span><span class="o">?</span><span class="n">x</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">;}</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="k">class</span><span class="o">...</span><span class="nc">Ts</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="kt">bool</span> <span class="nf">ckmin</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">Ts</span><span class="o">&amp;</span><span class="p">...</span><span class="n">xs</span><span class="p">){</span><span class="k">return</span> <span class="n">ckmin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">min</span><span class="p">(</span><span class="n">xs</span><span class="p">...));}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="kt">bool</span> <span class="nf">ckmax</span><span class="p">(</span><span class="n">T1</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">T2</span><span class="o">&amp;</span><span class="n">y</span><span class="p">){</span><span class="k">return</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">y</span><span class="o">?</span><span class="n">x</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">;}</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="k">class</span><span class="o">...</span><span class="nc">Ts</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="kt">bool</span> <span class="nf">ckmax</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">Ts</span><span class="o">&amp;</span><span class="p">...</span><span class="n">xs</span><span class="p">){</span><span class="k">return</span> <span class="n">ckmax</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">max</span><span class="p">(</span><span class="n">xs</span><span class="p">...));}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">,</span><span class="k">class</span> <span class="nc">T4</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span> <span class="k">operator</span><span class="o">+</span><span class="p">(</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="o">&gt;&amp;</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">mp</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">pf</span><span class="o">+</span><span class="n">b</span><span class="p">.</span><span class="n">pf</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">ps</span><span class="o">+</span><span class="n">b</span><span class="p">.</span><span class="n">ps</span><span class="p">);}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">,</span><span class="k">class</span> <span class="nc">T4</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span> <span class="k">operator</span><span class="o">-</span><span class="p">(</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="o">&gt;&amp;</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">mp</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">pf</span><span class="o">-</span><span class="n">b</span><span class="p">.</span><span class="n">pf</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">ps</span><span class="o">-</span><span class="n">b</span><span class="p">.</span><span class="n">ps</span><span class="p">);}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span> <span class="k">operator</span> <span class="o">*</span><span class="p">(</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">T3</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">mp</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">pf</span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">ps</span><span class="o">*</span><span class="n">b</span><span class="p">);}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span> <span class="k">operator</span> <span class="o">*</span><span class="p">(</span><span class="k">const</span> <span class="n">T1</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T2</span><span class="p">,</span><span class="n">T3</span><span class="o">&gt;&amp;</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">b</span><span class="o">*</span><span class="n">a</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span> <span class="k">operator</span> <span class="o">/</span><span class="p">(</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">T3</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">mp</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">pf</span><span class="o">/</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">ps</span><span class="o">/</span><span class="n">b</span><span class="p">);}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">,</span><span class="k">class</span> <span class="nc">T4</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">+=</span><span class="p">(</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">,</span><span class="k">class</span> <span class="nc">T4</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">-=</span><span class="p">(</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">*=</span><span class="p">(</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">T3</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">/=</span><span class="p">(</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">T3</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">/</span><span class="n">b</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="k">class</span> <span class="nc">U</span><span class="p">&gt;</span> <span class="kt">void</span> <span class="nf">erase</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span> <span class="n">t</span><span class="p">,</span><span class="k">const</span> <span class="n">U</span><span class="o">&amp;</span> <span class="n">u</span><span class="p">){</span><span class="k">auto</span> <span class="n">it</span><span class="o">=</span><span class="n">t</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="n">it</span><span class="o">!=</span><span class="n">end</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="n">t</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">it</span><span class="p">);}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="n">T</span> <span class="nf">pop</span><span class="p">(</span><span class="n">queue</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">){</span><span class="k">auto</span> <span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">front</span><span class="p">();</span> <span class="n">a</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span> <span class="k">return</span> <span class="n">b</span><span class="p">;}</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="k">auto</span> <span class="nf">pop</span><span class="p">(</span><span class="n">T</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">){</span><span class="k">auto</span> <span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">top</span><span class="p">();</span> <span class="n">a</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span> <span class="k">return</span> <span class="n">b</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="n">T</span> <span class="k">operator</span> <span class="o">-</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="kt">size_t</span> <span class="n">x</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="n">x</span><span class="p">];}</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="n">T</span> <span class="k">operator</span> <span class="o">-</span><span class="p">(</span><span class="n">deque</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="kt">size_t</span> <span class="n">x</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="n">x</span><span class="p">];}</span>
<span class="k">struct</span> <span class="nc">chash</span><span class="p">{</span>
    <span class="k">static</span> <span class="n">ll</span> <span class="n">splitmix64</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">){</span><span class="n">x</span><span class="o">+=</span><span class="mh">0x9e3779b97f4a7c15</span><span class="p">;</span> <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">30</span><span class="p">))</span><span class="o">*</span><span class="mh">0xbf58476d1ce4e5b9</span><span class="p">;</span> <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">27</span><span class="p">))</span><span class="o">*</span><span class="mh">0x94d049bb133111eb</span><span class="p">;</span> <span class="k">return</span> <span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">31</span><span class="p">);}</span>
    <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="kt">size_t</span> <span class="nf">operator</span><span class="p">()(</span><span class="k">const</span> <span class="n">T</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">)</span> <span class="k">const</span><span class="p">{</span><span class="k">return</span> <span class="n">splitmix64</span><span class="p">(</span><span class="n">hash</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">SEED</span><span class="p">);}</span>
    <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">&gt;</span> <span class="kt">size_t</span> <span class="nf">operator</span><span class="p">()(</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;&amp;</span><span class="n">x</span><span class="p">)</span><span class="k">const</span><span class="p">{</span><span class="k">return</span> <span class="mi">31</span><span class="o">*</span><span class="k">operator</span><span class="p">()(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="p">)</span><span class="o">+</span><span class="k">operator</span><span class="p">()(</span><span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="p">);}};</span>
<span class="k">struct</span> <span class="nc">mint</span> <span class="p">{</span><span class="c1">//thanks benq</span>
    <span class="c1">//static constexpr mint rt() { return RT; } // primitive root for FFT</span>
    <span class="kt">int</span> <span class="n">v</span><span class="p">;</span> <span class="k">explicit</span> <span class="k">operator</span> <span class="kt">int</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">v</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// explicit -&gt; don't silently convert to int</span>
    <span class="n">mint</span><span class="p">()</span><span class="o">:</span><span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{}</span>
    <span class="n">mint</span><span class="p">(</span><span class="n">ll</span> <span class="n">_v</span><span class="p">)</span> <span class="p">{</span> <span class="n">v</span> <span class="o">=</span> <span class="kt">int</span><span class="p">((</span><span class="o">-</span><span class="n">MOD</span> <span class="o">&lt;</span> <span class="n">_v</span> <span class="o">&amp;&amp;</span> <span class="n">_v</span> <span class="o">&lt;</span> <span class="n">MOD</span><span class="p">)</span> <span class="o">?</span> <span class="n">_v</span> <span class="o">:</span> <span class="n">_v</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">v</span> <span class="o">+=</span> <span class="n">MOD</span><span class="p">;</span> <span class="p">}</span>
    <span class="kt">bool</span> <span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">o</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">v</span> <span class="o">==</span> <span class="n">o</span><span class="p">.</span><span class="n">v</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">friend</span> <span class="kt">bool</span> <span class="k">operator</span><span class="o">!=</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">!</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">friend</span> <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">v</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">.</span><span class="n">v</span><span class="p">;</span> <span class="p">}</span>
    <span class="c1">//friend void re(mint&amp; a) { ll x; re(x); a = mint(x); }</span>
    <span class="c1">//friend string ts(mint a) { return ts(a.v); }</span>
    <span class="n">mint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">+=</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">v</span> <span class="o">+=</span> <span class="n">o</span><span class="p">.</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">MOD</span><span class="p">)</span> <span class="n">v</span> <span class="o">-=</span> <span class="n">MOD</span><span class="p">;</span>
        <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span> <span class="p">}</span>
    <span class="n">mint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">-=</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">v</span> <span class="o">-=</span> <span class="n">o</span><span class="p">.</span><span class="n">v</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">v</span> <span class="o">+=</span> <span class="n">MOD</span><span class="p">;</span>
        <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span> <span class="p">}</span>
    <span class="n">mint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">*=</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">v</span> <span class="o">=</span> <span class="kt">int</span><span class="p">((</span><span class="n">ll</span><span class="p">)</span><span class="n">v</span><span class="o">*</span><span class="n">o</span><span class="p">.</span><span class="n">v</span><span class="o">%</span><span class="n">MOD</span><span class="p">);</span> <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span> <span class="p">}</span>
    <span class="n">mint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">/=</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)</span> <span class="o">*=</span> <span class="n">inv</span><span class="p">(</span><span class="n">o</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">friend</span> <span class="n">mint</span> <span class="nf">pow</span><span class="p">(</span><span class="n">mint</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">mint</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">assert</span><span class="p">(</span><span class="n">p</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(;</span> <span class="n">p</span><span class="p">;</span> <span class="n">p</span> <span class="o">/=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">a</span> <span class="o">*=</span> <span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span> <span class="n">ans</span> <span class="o">*=</span> <span class="n">a</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">ans</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">friend</span> <span class="n">mint</span> <span class="nf">inv</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">)</span> <span class="p">{</span> <span class="n">assert</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">v</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">MOD</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> <span class="p">}</span>
    <span class="n">mint</span> <span class="k">operator</span><span class="o">-</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">mint</span><span class="p">(</span><span class="o">-</span><span class="n">v</span><span class="p">);</span> <span class="p">}</span>
    <span class="n">mint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">++</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="o">*</span><span class="k">this</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span>
    <span class="n">mint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">--</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="o">*</span><span class="k">this</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">friend</span> <span class="n">mint</span> <span class="k">operator</span><span class="o">+</span><span class="p">(</span><span class="n">mint</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">+=</span> <span class="n">b</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">friend</span> <span class="n">mint</span> <span class="k">operator</span><span class="o">-</span><span class="p">(</span><span class="n">mint</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">-=</span> <span class="n">b</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">friend</span> <span class="n">mint</span> <span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="n">mint</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">*=</span> <span class="n">b</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">friend</span> <span class="n">mint</span> <span class="k">operator</span><span class="o">/</span><span class="p">(</span><span class="n">mint</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">/=</span> <span class="n">b</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">friend</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">){</span> <span class="k">return</span> <span class="n">to_string</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">v</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">friend</span> <span class="n">std</span><span class="o">::</span><span class="n">ostream</span> <span class="o">&amp;</span> <span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">ostream</span> <span class="o">&amp;</span> <span class="n">Str</span><span class="p">,</span> <span class="n">mint</span> <span class="k">const</span> <span class="o">&amp;</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Str</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="p">.</span><span class="n">v</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">Str</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">friend</span> <span class="n">istream</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">istream</span><span class="o">&amp;</span> <span class="n">stream</span><span class="p">,</span>  <span class="n">mint</span><span class="o">&amp;</span> <span class="n">v</span><span class="p">){</span>
        <span class="n">stream</span><span class="o">&gt;&gt;</span><span class="n">v</span><span class="p">.</span><span class="n">v</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">stream</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="kt">void</span> <span class="nf">fin</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">){</span><span class="n">freopen</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="s">"r"</span><span class="p">,</span><span class="n">stdin</span><span class="p">);}</span> <span class="kt">void</span> <span class="nf">fout</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">){</span><span class="n">freopen</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="s">"w"</span><span class="p">,</span><span class="n">stdout</span><span class="p">);}</span> <span class="kt">void</span> <span class="nf">fio</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">){</span><span class="n">fin</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="s">".in"</span><span class="p">);</span> <span class="n">fout</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="s">".out"</span><span class="p">);}</span>
<span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="kt">char</span> <span class="n">c</span><span class="p">){</span><span class="k">return</span> <span class="n">string</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">);}</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">s</span><span class="p">){</span><span class="k">return</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="n">s</span><span class="p">;}</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">){</span><span class="k">return</span> <span class="n">s</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">){</span><span class="n">stringstream</span> <span class="n">ss</span><span class="p">;</span> <span class="n">ss</span><span class="o">&lt;&lt;</span><span class="n">c</span><span class="p">;</span> <span class="k">return</span> <span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">&gt;</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;</span> <span class="n">p</span><span class="p">){</span><span class="k">return</span> <span class="s">"("</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">pf</span><span class="p">)</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">ps</span><span class="p">)</span><span class="o">+</span><span class="s">")"</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">&gt;</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="n">tuple</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">,</span><span class="n">T3</span><span class="o">&gt;</span> <span class="n">p</span><span class="p">){</span><span class="k">auto</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">]</span><span class="o">=</span><span class="n">p</span><span class="p">;</span> <span class="k">return</span> <span class="s">"("</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s">")"</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">,</span><span class="k">class</span> <span class="nc">T4</span><span class="p">&gt;</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="n">tuple</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">,</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="o">&gt;</span> <span class="n">p</span><span class="p">){</span><span class="k">auto</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">]</span><span class="o">=</span><span class="n">p</span><span class="p">;</span> <span class="k">return</span> <span class="s">"("</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">+</span><span class="s">")"</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="n">T</span> <span class="n">v</span><span class="p">){</span><span class="n">string</span> <span class="n">ret</span><span class="o">=</span><span class="s">"{"</span><span class="p">;</span> <span class="k">for</span><span class="p">(</span><span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">x</span><span class="o">:</span><span class="n">v</span><span class="p">)</span> <span class="n">ret</span><span class="o">+=</span><span class="n">to_string</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s">","</span><span class="p">;</span> <span class="k">return</span> <span class="n">ret</span><span class="o">+</span><span class="s">"}"</span><span class="p">;}</span>
<span class="kt">void</span> <span class="nf">DBG</span><span class="p">(){</span><span class="n">cerr</span><span class="o">&lt;&lt;</span><span class="s">"]"</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;}</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="k">class</span><span class="o">...</span> <span class="nc">Ts</span><span class="p">&gt;</span> <span class="kt">void</span> <span class="nf">DBG</span><span class="p">(</span><span class="n">T</span> <span class="n">x</span><span class="p">,</span><span class="n">Ts</span><span class="p">...</span> <span class="n">xs</span><span class="p">){</span><span class="n">cerr</span><span class="o">&lt;&lt;</span><span class="n">to_string</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="k">if</span><span class="p">(</span><span class="k">sizeof</span><span class="p">...(</span><span class="n">xs</span><span class="p">))</span> <span class="n">cerr</span><span class="o">&lt;&lt;</span><span class="s">", "</span><span class="p">;</span> <span class="n">DBG</span><span class="p">(</span><span class="n">xs</span><span class="p">...);}</span>
<span class="cp">#ifdef LOCAL
</span>    <span class="cp">#define dbg(...) cerr&lt;&lt;"Line("&lt;&lt; __LINE__&lt;&lt;") -&gt; ["&lt;&lt;#__VA_ARGS__&lt;&lt;"]: [", DBG(__VA_ARGS__)
#else
</span>    <span class="cp">#define dbg(...) 0
#endif
#define nl "\n"
</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="n">P2</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="n">M</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">SegTree</span><span class="p">{</span>
    <span class="k">struct</span> <span class="nc">node</span><span class="p">{</span>
        <span class="n">ll</span> <span class="n">v</span><span class="o">=-</span><span class="n">INF</span><span class="p">,</span><span class="n">lz</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span> <span class="n">seg</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="p">];</span> <span class="c1">//replace 2*N with NN=N+(size)+10 to reduce memory</span>
    <span class="kt">void</span> <span class="nf">pull</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
        <span class="n">seg</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">v</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">seg</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">].</span><span class="n">v</span><span class="p">,</span><span class="n">seg</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">].</span><span class="n">v</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">push</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">seg</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">lz</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;</span><span class="n">N</span><span class="p">)</span> <span class="n">fori</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="n">seg</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">i</span><span class="p">].</span><span class="n">lz</span><span class="o">+=</span><span class="n">seg</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">lz</span><span class="p">;</span>
        <span class="n">seg</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">v</span><span class="o">+=</span><span class="n">seg</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">lz</span><span class="p">;</span>
        <span class="n">seg</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">lz</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">build</span><span class="p">(</span><span class="n">ll</span> <span class="o">*</span><span class="n">arr</span><span class="p">){</span>
        <span class="n">fori</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="n">seg</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">N</span><span class="p">].</span><span class="n">v</span><span class="o">=</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">ford</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="n">pull</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">upd</span><span class="p">(</span><span class="kt">int</span> <span class="n">lo</span><span class="p">,</span><span class="kt">int</span> <span class="n">hi</span><span class="p">,</span><span class="n">ll</span> <span class="n">v</span><span class="p">,</span><span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="o">=</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">){</span>
        <span class="n">push</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">hi</span><span class="o">&lt;</span><span class="n">l</span><span class="o">||</span><span class="n">r</span><span class="o">&lt;</span><span class="n">lo</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">lo</span><span class="o">&lt;=</span><span class="n">l</span><span class="o">&amp;&amp;</span><span class="n">r</span><span class="o">&lt;=</span><span class="n">hi</span><span class="p">){</span>
            <span class="n">seg</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">lz</span><span class="o">+=</span><span class="n">v</span><span class="p">;</span> <span class="n">push</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">upd</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span><span class="n">hi</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">);</span> <span class="n">upd</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span><span class="n">hi</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span> <span class="n">pull</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">ll</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">lo</span><span class="p">,</span><span class="kt">int</span> <span class="n">hi</span><span class="p">,</span><span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="o">=</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">hi</span><span class="o">&lt;</span><span class="n">l</span><span class="o">||</span><span class="n">r</span><span class="o">&lt;</span><span class="n">lo</span><span class="p">)</span> <span class="k">return</span> <span class="o">-</span><span class="n">INF</span><span class="p">;</span>
        <span class="n">push</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">lo</span><span class="o">&lt;=</span><span class="n">l</span><span class="o">&amp;&amp;</span><span class="n">r</span><span class="o">&lt;=</span><span class="n">hi</span><span class="p">)</span> <span class="k">return</span> <span class="n">seg</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">v</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">max</span><span class="p">(</span><span class="n">query</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span><span class="n">hi</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">),</span><span class="n">query</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span><span class="n">hi</span><span class="p">,</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="n">st</span><span class="p">;</span>
<span class="n">ll</span> <span class="n">n</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">;</span>
<span class="n">stack</span><span class="o">&lt;</span><span class="n">pll</span><span class="o">&gt;</span> <span class="n">s</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">CHECKTHIS</span><span class="p">(){</span>
    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="n">K</span><span class="p">;</span>
    <span class="n">fori</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">){</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">s</span><span class="p">.</span><span class="n">em</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">inf</span><span class="p">);</span>
    <span class="n">st</span><span class="p">.</span><span class="n">upd</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">INF</span><span class="p">);</span>
    <span class="n">fori</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">){</span>
        <span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="n">K</span><span class="p">;</span>
        <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">K</span><span class="o">+</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">;</span>
        <span class="n">ckmax</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">assert</span><span class="p">(</span><span class="n">y</span><span class="o">&lt;</span><span class="n">i</span><span class="p">);</span>
        <span class="k">while</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">top</span><span class="p">().</span><span class="n">ps</span><span class="o">&lt;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
            <span class="k">auto</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span><span class="o">=</span><span class="n">pop</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
            <span class="n">z</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">top</span><span class="p">().</span><span class="n">pf</span><span class="p">;</span>
            <span class="n">st</span><span class="p">.</span><span class="n">upd</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="n">y</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">z</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">top</span><span class="p">().</span><span class="n">pf</span><span class="p">;</span>
        <span class="n">st</span><span class="p">.</span><span class="n">upd</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="n">s</span><span class="p">.</span><span class="n">em</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">st</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
        <span class="n">st</span><span class="p">.</span><span class="n">upd</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">INF</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">f</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">nl</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="cp">#ifdef LOCAL
</span>        <span class="c1">//fin("a.txt");</span>
    <span class="cp">#endif
</span>    <span class="kt">int</span> <span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="c1">//cin&gt;&gt;T;</span>
    <span class="n">foru</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">){</span>
        <span class="n">CHECKTHIS</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/**

*/</span>
    </code></pre></figure>

</details>

<p>No need to prove anything about the transitions.</p>

<h2 id="olympiads-computing-competition">Olympiads Computing Competition</h2>

<p><a href="https://dmoj.ca/problems/?search=occ+%2719">Link</a></p>

<p>Never got around to solving this one.</p>

<ul>
  <li>g6
    <ul>
      <li>centroid</li>
    </ul>
  </li>
  <li>g5
    <ul>
      <li>k&lt;=10 only</li>
      <li>try all 1000 max weights, for each find max vertex cover in 2^k</li>
    </ul>
  </li>
  <li>g4
    <ul>
      <li>this is just 2d range sum</li>
    </ul>
  </li>
  <li>g3
    <ul>
      <li>dp[l][r][c]=max value to convert [l,r] to c</li>
      <li>for interval of length x try all subintervals of length x-k+1</li>
    </ul>
  </li>
  <li>g2
    <ul>
      <li>need to find every prefix sum p[x], in one query you can get p[x]-p[y], you already know p[0]</li>
      <li>always do either (0,x) or (x,n) query</li>
    </ul>
  </li>
  <li>g1
    <ul>
      <li>already solved</li>
    </ul>
  </li>
  <li>s6
    <ul>
      <li>insert cities in increasing toll, do dsu</li>
      <li>try all query ends in the smaller component, check if the other end is in the other component</li>
      <li>why is it restricted to 5 roads per city?</li>
    </ul>
  </li>
</ul>

<h2 id="codeforces-global-9-i-1375i---cubic-lattice">Codeforces Global 9 I (1375I) - Cubic Lattice</h2>

<p><a href="https://codeforces.com/contest/1375/problem/I">Link</a></p>

<p>I didn’t actually solve or even look at this problem before, but while I was testing the round I heard a lot about how impossible this problem was to solve and it seemed quite scary. I also wondered if I would ever be able to solve such a problem. Well, the problem was rated 4363r which was in my range last month for practice, so now seems like a good time.</p>

<p>So it’s clear that the 3 vectors need to divide each respective component of each point. If you use an algebraic structure where right angle rotation is equivalent to multiplication, such as complex numbers for 2 dimensions or quaternions for 3 dimensions, then you just need to find one number that divides all other numbers. So basically this problem is calculating GCD in quaternions. I’m not sure if the regular euclid algorithm works here, but this seems like a lot of math.</p>

<p>I looked at the editorial and yeah, almost all of it is trying to figure out how to do GCD on quaternions. This isn’t really a programming problem. Disappointing</p>

<h2 id="canadian-computing-olympiad-day-2">Canadian Computing Olympiad Day 2</h2>

<p><a href="https://dmoj.ca/contest/cco21d2">Link</a></p>

<p>I solved none of these problems when I did the contest. But this time it wasn’t because of any stupid error, the problems were just hard. After the contest, I decided to save these problems until I got better, and hopefully I’m better now.</p>

<p>For each problem I have recorded my notes/thought process.</p>

<h3 id="p4---travelling-merchant">P4 - Travelling Merchant</h3>

<ul>
  <li>assume you have a strong connected component with no edges going out</li>
  <li>find the smallest edge from each node, that’s a lower bound</li>
  <li>find the node with largest lower bound in the connected component
    <ul>
      <li>that’s an upper bound for the connected component</li>
      <li>so for that node, the upper and lower bounds equal, answer is known</li>
    </ul>
  </li>
  <li>now remove the node
    <ul>
      <li>so now the component will be split into several smaller components, repeat the process on the leaf component</li>
      <li>for each node leading into it, update its lower bound</li>
      <li>and update the upper bound for the remaining  connected component</li>
    </ul>
  </li>
</ul>

<h3 id="p5---weird-numeral-system">P5 - Weird Numeral System</h3>
<ul>
  <li>so for each distance, choose the best cutoff point</li>
  <li>f[x]=min cost for x..n, assume dist[1..x-1]=0</li>
  <li>let k be such that dep[k-1]=dep[i], dep[k]=dep[i]+1
    <ul>
      <li>and k&gt;max_child[1..i-1]</li>
    </ul>
  </li>
  <li>f[i]=max_child[1..i-1]-i-(nodes i..n with a parent&lt;i)+(k-max_child[1..i-1])+f[k]
    <ul>
      <li>find max_child[1..i-1] with prefix  max</li>
      <li>find (nodes i..n with a parent&lt;i) with BIT</li>
    </ul>
  </li>
  <li>then f[i]=A+k+f[k] for k&gt;B
    <ul>
      <li>find in O(1) using suffix max</li>
    </ul>
  </li>
</ul>

<h3 id="p6---loop-town">P6 - Loop Town</h3>
<ul>
  <li>plot (i,p[i])</li>
  <li>each point x,y can be replaced with (x-n,y), (x,y+n)</li>
</ul>

<p>editor’s note: split means moving a point \((x,y)\) up by \(n\), effectively “splitting” it into \((x,y+n)\) and \((x-n,y)\)</p>

<ul>
  <li>if j&lt;i, p[j]&lt;p[j], and i is split, j must be split
    <ul>
      <li>this greatly simplifies the structure</li>
    </ul>
  </li>
  <li>can a point be split more than once?
    <ul>
      <li>i’m guessing no, but the reasoning is not clear</li>
      <li>no - it increases inversion of everything in original block</li>
      <li>wait maybe?</li>
      <li>no - the only benefit of splitting is a subset of the original block</li>
      <li>wait</li>
      <li>NO</li>
    </ul>
  </li>
  <li>ok so from here n^2 dp is already apparent, maybe need some segment tree trickery?</li>
  <li>
    <p>maybe not</p>
  </li>
  <li>consider the contribution of each point splits
    <ul>
      <li>all nonsplit points in the top left: -1 inversion</li>
      <li>all nonsplit points in the top right or bottom left: +1 inversion</li>
      <li>unsplit points in bottom right: impossible in optimal solution
<img src="/assets/images/loop-town-figure2.png" alt="Figure 2" /></li>
    </ul>
  </li>
  <li>this can be cleanly separated, in a way so you don’t care if the other points are split or not:
    <ul>
      <li>in the end, subtract K(K-1) if you split K points</li>
      <li>+1 for everything in top right or bottom left</li>
      <li>-1 for everything in top left, +1 for everything in bottom right
        <ul>
          <li>so two split points with this relationship will cancel out</li>
        </ul>
      </li>
      <li>another +2 for everything in bottom right to compensate for subtracting K(K-1) at the end</li>
    </ul>
  </li>
</ul>

<p>editor note: proof/more detailed explanation</p>

<p>first, calculate number of initial inversions before splitting any point</p>

<p>a pair of points is \((p_1=(x_1,y_1), p_2=(x_2,y_2)), p_1 \neq p_2\)</p>

<p>let \(a\) be number of pair of points where \(p_1\) is top right or bottom left of \(p_2\), and exactly one point is split</p>

<p>let \(b\) be the number of pairs of points where a split \(p_1\) is to the bottom right of the unsplit \(p_2\)</p>

<p>then the answer is initial inversions \(+a-b\)</p>

<p>let \(c=\) #pairs where split \(p_1\) is bottom right of \(p_2\)</p>

<p>\(d=\) #pairs where split \(p_1\) is top left of \(p_2\)</p>

<p>\(e=\) #pairs where a split \(p_1\) is top right or bottom left of any \(p_2\)</p>

<p>\(f=\) #pairs where \(p_1,p_2\) are both split</p>

<p>remember that if \(p_1\) is split and \(p_1\) is to the top left of \(p_2\), then \(p_2\) must be also split.</p>

<p>\(b = c -\) #pairs where split \(p_1\) is top left of \(p_2\) (which will always also be split) \(=c-d\).</p>

<p>\(a= e -\) #pairs where split \(p_1\) is to the top right or bottom left of split \(p_2\)</p>

<p>\(=e - (\) #pairs where \(p_1,p_2\) are both split - #pairs where \(p_1,p_2\) are split and \(p_1\) is top right or bottom left of \(p_2)\)</p>

<p>\(=e - (f -\) #pairs where \(p_1,p_2\) are split and \(p_1\) is top right or bottom left of \(p_2)\)</p>

<p>\(= e-(f- 2 c)\) .</p>

<p>so what is needed is \(c,d,e,f\). \(f=K(K-1)\), while the contribution to \(c,d,e\) (and thus the final number of inversions) of splitting a point is independent of any other points.</p>

<ul>
  <li>so then you can sort points by contribution and try for every K, choosing the K best points greedily</li>
  <li>except it’s possible for a point to be more than n higher than lower than another point
    <ul>
      <li>for those points, shift x and y by a multiple of n when doing calculations</li>
    </ul>
  </li>
</ul>

<p><img src="/assets/images/loop-town-figure.png" alt="loop town figure" />
<em>To calculate value for circled point, count the points in each box and multiply by the appropriate value for that box. Note that the green boxes extend infinitely horizontally, while the the red boxes don’t.</em></p>

<details>
    <summary>Code</summary>
    
    Notice how the contribution of each point can be separately calculated and sorted.
    
<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
</pre></td><td class="code"><pre> 
<span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ext/pb_ds/assoc_container.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ext/pb_ds/tree_policy.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ext/pb_ds/priority_queue.hpp&gt;</span><span class="cp">
#ifndef LOCAL</span><span class="cm">/*
    #pragma GCC optimize("Ofast")
    #pragma GCC optimize "unroll-loops"
    #pragma GCC target "mmx,sse,sse2,sse3,sse4,avx,avx2,fma,abm,popcnt,tune=native" //*/</span><span class="cp">
</span>    <span class="c1">//#pragma GCC optimize "prefetch-loop-arrays"</span>
<span class="cp">#endif // LOCAL
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span> <span class="k">using</span> <span class="k">namespace</span> <span class="n">__gnu_pbds</span><span class="p">;</span>
<span class="cp">#define foru(i,a,b) for(ll i=(a);i&lt;(b);i++)
#define ford(i,a,b) for(ll i=(a)-1;i&gt;=(b);i--)
#define fori(a,b) foru(i,a,b)
#define forj(a,b) foru(j,a,b)
#define fork(a,b) foru(k,a,b)
#define seto(x,i) memset(x,i,sizeof x)
#define pf first
#define ps second
#define pb push_back
#define eb emplace_back
#define em emplace
#define mp make_pair
#define mt make_tuple
#define popcount __builtin_popcount
#define popcountll __builtin_popcountll
#define clz __builtin_clz
#define clzll __builtin_clzll
#define ctz __builtin_ctz
#define ctzll __builtin_ctzll
#define P2(x) (1LL&lt;&lt;(x))
#define sz(x) (ll)x.size()
#define all(x) begin(x),end(x)
#define lwb lower_bound
#define upb upper_bound
#if __SIZEOF_INT128__
</span>    <span class="k">typedef</span> <span class="n">__int128_t</span> <span class="n">i128</span><span class="p">;</span> <span class="k">typedef</span> <span class="n">__uint128_t</span> <span class="n">ui128</span><span class="p">;</span>
<span class="cp">#endif
</span><span class="k">typedef</span> <span class="kt">int64_t</span> <span class="n">ll</span><span class="p">;</span>  <span class="k">typedef</span> <span class="kt">uint64_t</span> <span class="n">ull</span><span class="p">;</span> <span class="k">typedef</span> <span class="kt">long</span> <span class="kt">double</span> <span class="n">lld</span><span class="p">;</span> <span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">pii</span><span class="p">;</span> <span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">pll</span><span class="p">;</span> <span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">lld</span><span class="p">,</span><span class="n">lld</span><span class="o">&gt;</span> <span class="n">pdd</span><span class="p">;</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">&gt;</span> <span class="k">using</span> <span class="n">ordered_map</span><span class="o">=</span><span class="n">tree</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">,</span><span class="n">less</span><span class="o">&lt;</span><span class="n">T1</span><span class="o">&gt;</span><span class="p">,</span><span class="n">rb_tree_tag</span><span class="p">,</span><span class="n">tree_order_statistics_node_update</span><span class="o">&gt;</span><span class="p">;</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">&gt;</span> <span class="k">using</span> <span class="n">ordered_set</span><span class="o">=</span><span class="n">ordered_map</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">null_type</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="k">using</span> <span class="n">minpq</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="n">greater</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">;</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="k">using</span> <span class="n">maxpq</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="n">less</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">;</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="k">using</span> <span class="n">minpairingheap</span><span class="o">=</span><span class="n">__gnu_pbds</span><span class="o">::</span><span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">greater</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="n">pairing_heap_tag</span><span class="o">&gt;</span><span class="p">;</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span><span class="k">using</span> <span class="n">maxpairingheap</span><span class="o">=</span><span class="n">__gnu_pbds</span><span class="o">::</span><span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">less</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="n">pairing_heap_tag</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">inf</span><span class="o">=</span><span class="mh">0x3f3f3f3f</span><span class="p">,</span><span class="n">MOD</span><span class="o">=</span><span class="mf">1e9</span><span class="o">+</span><span class="mi">7</span><span class="p">;</span> <span class="k">const</span> <span class="n">ll</span> <span class="n">INF</span><span class="o">=</span><span class="mh">0x3f3f3f3f3f3f3f3f</span><span class="p">;</span> <span class="k">const</span> <span class="n">lld</span> <span class="n">PI</span><span class="o">=</span><span class="n">acos</span><span class="p">((</span><span class="n">lld</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">SEED</span><span class="o">=</span><span class="mi">443214</span><span class="o">^</span><span class="n">chrono</span><span class="o">::</span><span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">chrono</span><span class="o">::</span><span class="n">nanoseconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">chrono</span><span class="o">::</span><span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">().</span><span class="n">time_since_epoch</span><span class="p">()).</span><span class="n">count</span><span class="p">();</span>
<span class="n">mt19937</span> <span class="nf">randgen</span><span class="p">(</span><span class="n">SEED</span><span class="p">);</span> <span class="n">ll</span> <span class="nf">rand</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">uniform_int_distribution</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)(</span><span class="n">randgen</span><span class="p">);}</span>
<span class="n">ll</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">b</span><span class="o">?</span><span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">)</span><span class="o">:</span><span class="n">a</span><span class="p">;}</span>
<span class="n">ll</span> <span class="nf">fpow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">){</span><span class="n">ll</span> <span class="n">ret</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span> <span class="n">ret</span><span class="o">=</span><span class="n">ret</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">MOD</span><span class="p">;}</span><span class="k">return</span> <span class="n">ret</span><span class="p">;}</span> <span class="n">ll</span> <span class="nf">fpow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">,</span><span class="n">ll</span> <span class="n">M</span><span class="p">){</span><span class="n">ll</span> <span class="n">ret</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span> <span class="n">ret</span><span class="o">=</span><span class="n">ret</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">M</span><span class="p">;</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">M</span><span class="p">;}</span><span class="k">return</span> <span class="n">ret</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span> <span class="nf">_min</span><span class="p">(</span><span class="k">const</span> <span class="n">T1</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">T2</span><span class="o">&amp;</span><span class="n">y</span><span class="p">){</span><span class="k">return</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">y</span><span class="o">?</span><span class="n">x</span><span class="o">:</span><span class="n">y</span><span class="p">;}</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="k">class</span><span class="o">...</span><span class="nc">Ts</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="k">auto</span> <span class="nf">_min</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">Ts</span><span class="o">&amp;</span><span class="p">...</span><span class="n">xs</span><span class="p">){</span><span class="k">return</span> <span class="n">_min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">_min</span><span class="p">(</span><span class="n">xs</span><span class="p">...));}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span> <span class="nf">_max</span><span class="p">(</span><span class="k">const</span> <span class="n">T1</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">T2</span><span class="o">&amp;</span><span class="n">y</span><span class="p">){</span><span class="k">return</span> <span class="n">x</span><span class="o">&gt;</span><span class="n">y</span><span class="o">?</span><span class="n">x</span><span class="o">:</span><span class="n">y</span><span class="p">;}</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="k">class</span><span class="o">...</span><span class="nc">Ts</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="k">auto</span> <span class="nf">_max</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">Ts</span><span class="o">&amp;</span><span class="p">...</span><span class="n">xs</span><span class="p">){</span><span class="k">return</span> <span class="n">_max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">_max</span><span class="p">(</span><span class="n">xs</span><span class="p">...));}</span>
<span class="cp">#define min(...) _min(__VA_ARGS__)
#define max(...) _max(__VA_ARGS__)
</span><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="kt">bool</span> <span class="nf">ckmin</span><span class="p">(</span><span class="n">T1</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">T2</span><span class="o">&amp;</span><span class="n">y</span><span class="p">){</span><span class="k">return</span> <span class="n">x</span><span class="o">&gt;</span><span class="n">y</span><span class="o">?</span><span class="n">x</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">;}</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="k">class</span><span class="o">...</span><span class="nc">Ts</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="kt">bool</span> <span class="nf">ckmin</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">Ts</span><span class="o">&amp;</span><span class="p">...</span><span class="n">xs</span><span class="p">){</span><span class="k">return</span> <span class="n">ckmin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">min</span><span class="p">(</span><span class="n">xs</span><span class="p">...));}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="kt">bool</span> <span class="nf">ckmax</span><span class="p">(</span><span class="n">T1</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">T2</span><span class="o">&amp;</span><span class="n">y</span><span class="p">){</span><span class="k">return</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">y</span><span class="o">?</span><span class="n">x</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">;}</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="k">class</span><span class="o">...</span><span class="nc">Ts</span><span class="p">&gt;</span><span class="k">constexpr</span> <span class="kt">bool</span> <span class="nf">ckmax</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="k">const</span> <span class="n">Ts</span><span class="o">&amp;</span><span class="p">...</span><span class="n">xs</span><span class="p">){</span><span class="k">return</span> <span class="n">ckmax</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">max</span><span class="p">(</span><span class="n">xs</span><span class="p">...));}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">,</span><span class="k">class</span> <span class="nc">T4</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span> <span class="k">operator</span><span class="o">+</span><span class="p">(</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="o">&gt;&amp;</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">mp</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">pf</span><span class="o">+</span><span class="n">b</span><span class="p">.</span><span class="n">pf</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">ps</span><span class="o">+</span><span class="n">b</span><span class="p">.</span><span class="n">ps</span><span class="p">);}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">,</span><span class="k">class</span> <span class="nc">T4</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span> <span class="k">operator</span><span class="o">-</span><span class="p">(</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="o">&gt;&amp;</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">mp</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">pf</span><span class="o">-</span><span class="n">b</span><span class="p">.</span><span class="n">pf</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">ps</span><span class="o">-</span><span class="n">b</span><span class="p">.</span><span class="n">ps</span><span class="p">);}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span> <span class="k">operator</span> <span class="o">*</span><span class="p">(</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">T3</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">mp</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">pf</span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">ps</span><span class="o">*</span><span class="n">b</span><span class="p">);}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span> <span class="k">operator</span> <span class="o">*</span><span class="p">(</span><span class="k">const</span> <span class="n">T1</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T2</span><span class="p">,</span><span class="n">T3</span><span class="o">&gt;&amp;</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">b</span><span class="o">*</span><span class="n">a</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span> <span class="k">operator</span> <span class="o">/</span><span class="p">(</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">T3</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">mp</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">pf</span><span class="o">/</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">ps</span><span class="o">/</span><span class="n">b</span><span class="p">);}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">,</span><span class="k">class</span> <span class="nc">T4</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">+=</span><span class="p">(</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">,</span><span class="k">class</span> <span class="nc">T4</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">-=</span><span class="p">(</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">*=</span><span class="p">(</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">T3</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">&gt;</span> <span class="k">constexpr</span> <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">/=</span><span class="p">(</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">T3</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">/</span><span class="n">b</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="k">class</span> <span class="nc">U</span><span class="p">&gt;</span> <span class="kt">void</span> <span class="nf">erase</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span> <span class="n">t</span><span class="p">,</span><span class="k">const</span> <span class="n">U</span><span class="o">&amp;</span> <span class="n">u</span><span class="p">){</span><span class="k">auto</span> <span class="n">it</span><span class="o">=</span><span class="n">t</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">);</span><span class="k">if</span><span class="p">(</span><span class="n">it</span><span class="o">!=</span><span class="n">end</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="n">t</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">it</span><span class="p">);}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="n">T</span> <span class="nf">pop</span><span class="p">(</span><span class="n">queue</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">){</span><span class="k">auto</span> <span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">front</span><span class="p">();</span> <span class="n">a</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span> <span class="k">return</span> <span class="n">b</span><span class="p">;}</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="k">auto</span> <span class="nf">pop</span><span class="p">(</span><span class="n">T</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">){</span><span class="k">auto</span> <span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">top</span><span class="p">();</span> <span class="n">a</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span> <span class="k">return</span> <span class="n">b</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="n">T</span> <span class="k">operator</span> <span class="o">-</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="kt">size_t</span> <span class="n">x</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="n">x</span><span class="p">];}</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="n">T</span> <span class="k">operator</span> <span class="o">-</span><span class="p">(</span><span class="n">deque</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="kt">size_t</span> <span class="n">x</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="n">x</span><span class="p">];}</span>
<span class="k">struct</span> <span class="nc">chash</span><span class="p">{</span>
    <span class="k">static</span> <span class="n">ll</span> <span class="n">splitmix64</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">){</span><span class="n">x</span><span class="o">+=</span><span class="mh">0x9e3779b97f4a7c15</span><span class="p">;</span> <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">30</span><span class="p">))</span><span class="o">*</span><span class="mh">0xbf58476d1ce4e5b9</span><span class="p">;</span> <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">27</span><span class="p">))</span><span class="o">*</span><span class="mh">0x94d049bb133111eb</span><span class="p">;</span> <span class="k">return</span> <span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="mi">31</span><span class="p">);}</span>
    <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="kt">size_t</span> <span class="nf">operator</span><span class="p">()(</span><span class="k">const</span> <span class="n">T</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">)</span> <span class="k">const</span><span class="p">{</span><span class="k">return</span> <span class="n">splitmix64</span><span class="p">(</span><span class="n">hash</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">SEED</span><span class="p">);}</span>
    <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">&gt;</span> <span class="kt">size_t</span> <span class="nf">operator</span><span class="p">()(</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;&amp;</span><span class="n">x</span><span class="p">)</span><span class="k">const</span><span class="p">{</span><span class="k">return</span> <span class="mi">31</span><span class="o">*</span><span class="k">operator</span><span class="p">()(</span><span class="n">x</span><span class="p">.</span><span class="n">first</span><span class="p">)</span><span class="o">+</span><span class="k">operator</span><span class="p">()(</span><span class="n">x</span><span class="p">.</span><span class="n">second</span><span class="p">);}};</span>
<span class="k">struct</span> <span class="nc">mint</span> <span class="p">{</span><span class="c1">//thanks benq</span>
	<span class="c1">//static constexpr mint rt() { return RT; } // primitive root for FFT</span>
	<span class="kt">int</span> <span class="n">v</span><span class="p">;</span> <span class="k">explicit</span> <span class="k">operator</span> <span class="kt">int</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">v</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// explicit -&gt; don't silently convert to int</span>
	<span class="n">mint</span><span class="p">()</span><span class="o">:</span><span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{}</span>
	<span class="n">mint</span><span class="p">(</span><span class="n">ll</span> <span class="n">_v</span><span class="p">)</span> <span class="p">{</span> <span class="n">v</span> <span class="o">=</span> <span class="kt">int</span><span class="p">((</span><span class="o">-</span><span class="n">MOD</span> <span class="o">&lt;</span> <span class="n">_v</span> <span class="o">&amp;&amp;</span> <span class="n">_v</span> <span class="o">&lt;</span> <span class="n">MOD</span><span class="p">)</span> <span class="o">?</span> <span class="n">_v</span> <span class="o">:</span> <span class="n">_v</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">v</span> <span class="o">+=</span> <span class="n">MOD</span><span class="p">;</span> <span class="p">}</span>
	<span class="kt">bool</span> <span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">o</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">v</span> <span class="o">==</span> <span class="n">o</span><span class="p">.</span><span class="n">v</span><span class="p">;</span> <span class="p">}</span>
	<span class="k">friend</span> <span class="kt">bool</span> <span class="k">operator</span><span class="o">!=</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="o">!</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">);</span> <span class="p">}</span>
	<span class="k">friend</span> <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">v</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">.</span><span class="n">v</span><span class="p">;</span> <span class="p">}</span>
	<span class="c1">//friend void re(mint&amp; a) { ll x; re(x); a = mint(x); }</span>
	<span class="c1">//friend string ts(mint a) { return ts(a.v); }</span>
	<span class="n">mint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">+=</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">v</span> <span class="o">+=</span> <span class="n">o</span><span class="p">.</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">MOD</span><span class="p">)</span> <span class="n">v</span> <span class="o">-=</span> <span class="n">MOD</span><span class="p">;</span>
		<span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span> <span class="p">}</span>
	<span class="n">mint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">-=</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">v</span> <span class="o">-=</span> <span class="n">o</span><span class="p">.</span><span class="n">v</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">v</span> <span class="o">+=</span> <span class="n">MOD</span><span class="p">;</span>
		<span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span> <span class="p">}</span>
	<span class="n">mint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">*=</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">v</span> <span class="o">=</span> <span class="kt">int</span><span class="p">((</span><span class="n">ll</span><span class="p">)</span><span class="n">v</span><span class="o">*</span><span class="n">o</span><span class="p">.</span><span class="n">v</span><span class="o">%</span><span class="n">MOD</span><span class="p">);</span> <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span> <span class="p">}</span>
	<span class="n">mint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">/=</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)</span> <span class="o">*=</span> <span class="n">inv</span><span class="p">(</span><span class="n">o</span><span class="p">);</span> <span class="p">}</span>
	<span class="k">friend</span> <span class="n">mint</span> <span class="nf">pow</span><span class="p">(</span><span class="n">mint</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">mint</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">assert</span><span class="p">(</span><span class="n">p</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(;</span> <span class="n">p</span><span class="p">;</span> <span class="n">p</span> <span class="o">/=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">a</span> <span class="o">*=</span> <span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span> <span class="n">ans</span> <span class="o">*=</span> <span class="n">a</span><span class="p">;</span>
		<span class="k">return</span> <span class="n">ans</span><span class="p">;</span> <span class="p">}</span>
	<span class="k">friend</span> <span class="n">mint</span> <span class="nf">inv</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">)</span> <span class="p">{</span> <span class="n">assert</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">v</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">MOD</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> <span class="p">}</span>

	<span class="n">mint</span> <span class="k">operator</span><span class="o">-</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">mint</span><span class="p">(</span><span class="o">-</span><span class="n">v</span><span class="p">);</span> <span class="p">}</span>
	<span class="n">mint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">++</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="o">*</span><span class="k">this</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span>
	<span class="n">mint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">--</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="o">*</span><span class="k">this</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span>
	<span class="k">friend</span> <span class="n">mint</span> <span class="k">operator</span><span class="o">+</span><span class="p">(</span><span class="n">mint</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">+=</span> <span class="n">b</span><span class="p">;</span> <span class="p">}</span>
	<span class="k">friend</span> <span class="n">mint</span> <span class="k">operator</span><span class="o">-</span><span class="p">(</span><span class="n">mint</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">-=</span> <span class="n">b</span><span class="p">;</span> <span class="p">}</span>
	<span class="k">friend</span> <span class="n">mint</span> <span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="n">mint</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">*=</span> <span class="n">b</span><span class="p">;</span> <span class="p">}</span>
	<span class="k">friend</span> <span class="n">mint</span> <span class="k">operator</span><span class="o">/</span><span class="p">(</span><span class="n">mint</span> <span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">/=</span> <span class="n">b</span><span class="p">;</span> <span class="p">}</span>
	<span class="k">friend</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="k">const</span> <span class="n">mint</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">){</span> <span class="k">return</span> <span class="n">to_string</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">v</span><span class="p">);</span> <span class="p">}</span>
	<span class="k">friend</span> <span class="n">std</span><span class="o">::</span><span class="n">ostream</span> <span class="o">&amp;</span> <span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">ostream</span> <span class="o">&amp;</span> <span class="n">Str</span><span class="p">,</span> <span class="n">mint</span> <span class="k">const</span> <span class="o">&amp;</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">Str</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="p">.</span><span class="n">v</span><span class="p">;</span>
      <span class="k">return</span> <span class="n">Str</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">friend</span> <span class="n">istream</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">istream</span><span class="o">&amp;</span> <span class="n">stream</span><span class="p">,</span>  <span class="n">mint</span><span class="o">&amp;</span> <span class="n">v</span><span class="p">){</span>
        <span class="n">stream</span><span class="o">&gt;&gt;</span><span class="n">v</span><span class="p">.</span><span class="n">v</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">stream</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="kt">void</span> <span class="nf">fin</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">){</span><span class="n">freopen</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="s">"r"</span><span class="p">,</span><span class="n">stdin</span><span class="p">);}</span> <span class="kt">void</span> <span class="nf">fout</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">){</span><span class="n">freopen</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="s">"w"</span><span class="p">,</span><span class="n">stdout</span><span class="p">);}</span> <span class="kt">void</span> <span class="nf">fio</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">){</span><span class="n">fin</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="s">".in"</span><span class="p">);</span> <span class="n">fout</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="s">".out"</span><span class="p">);}</span>
<span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="kt">char</span> <span class="n">c</span><span class="p">){</span><span class="k">return</span> <span class="n">string</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">);}</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">s</span><span class="p">){</span><span class="k">return</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="n">s</span><span class="p">;}</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="n">string</span> <span class="n">s</span><span class="p">){</span><span class="k">return</span> <span class="n">s</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">){</span><span class="n">stringstream</span> <span class="n">ss</span><span class="p">;</span> <span class="n">ss</span><span class="o">&lt;&lt;</span><span class="n">c</span><span class="p">;</span> <span class="k">return</span> <span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">&gt;</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="o">&gt;</span> <span class="n">p</span><span class="p">){</span><span class="k">return</span> <span class="s">"("</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">pf</span><span class="p">)</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">ps</span><span class="p">)</span><span class="o">+</span><span class="s">")"</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">&gt;</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="n">tuple</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">,</span><span class="n">T3</span><span class="o">&gt;</span> <span class="n">p</span><span class="p">){</span><span class="k">auto</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">]</span><span class="o">=</span><span class="n">p</span><span class="p">;</span> <span class="k">return</span> <span class="s">"("</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s">")"</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T1</span><span class="p">,</span><span class="k">class</span> <span class="nc">T2</span><span class="p">,</span><span class="k">class</span> <span class="nc">T3</span><span class="p">,</span><span class="k">class</span> <span class="nc">T4</span><span class="p">&gt;</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="n">tuple</span><span class="o">&lt;</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">,</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="o">&gt;</span> <span class="n">p</span><span class="p">){</span><span class="k">auto</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">]</span><span class="o">=</span><span class="n">p</span><span class="p">;</span> <span class="k">return</span> <span class="s">"("</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">to_string</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">+</span><span class="s">")"</span><span class="p">;}</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="n">string</span> <span class="nf">to_string</span><span class="p">(</span><span class="n">T</span> <span class="n">v</span><span class="p">){</span><span class="n">string</span> <span class="n">ret</span><span class="o">=</span><span class="s">"{"</span><span class="p">;</span> <span class="k">for</span><span class="p">(</span><span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">x</span><span class="o">:</span><span class="n">v</span><span class="p">)</span> <span class="n">ret</span><span class="o">+=</span><span class="n">to_string</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s">","</span><span class="p">;</span> <span class="k">return</span> <span class="n">ret</span><span class="o">+</span><span class="s">"}"</span><span class="p">;}</span>
<span class="kt">void</span> <span class="nf">DBG</span><span class="p">(){</span><span class="n">cerr</span><span class="o">&lt;&lt;</span><span class="s">"]"</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;}</span> <span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">,</span><span class="k">class</span><span class="o">...</span> <span class="nc">Ts</span><span class="p">&gt;</span> <span class="kt">void</span> <span class="nf">DBG</span><span class="p">(</span><span class="n">T</span> <span class="n">x</span><span class="p">,</span><span class="n">Ts</span><span class="p">...</span> <span class="n">xs</span><span class="p">){</span><span class="n">cerr</span><span class="o">&lt;&lt;</span><span class="n">to_string</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="k">if</span><span class="p">(</span><span class="k">sizeof</span><span class="p">...(</span><span class="n">xs</span><span class="p">))</span> <span class="n">cerr</span><span class="o">&lt;&lt;</span><span class="s">", "</span><span class="p">;</span> <span class="n">DBG</span><span class="p">(</span><span class="n">xs</span><span class="p">...);}</span>
<span class="cp">#ifdef LOCAL
</span>    <span class="cp">#define dbg(...) cerr&lt;&lt;"Line("&lt;&lt; __LINE__&lt;&lt;") -&gt; ["&lt;&lt;#__VA_ARGS__&lt;&lt;"]: [", DBG(__VA_ARGS__)
#else
</span>    <span class="cp">#define dbg(...) 0
#endif
#define nl "\n"
</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="mf">2e6</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">BITree</span><span class="p">{</span>
    <span class="n">ll</span> <span class="n">bit</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
    <span class="kt">void</span> <span class="n">upd</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">v</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="n">ckmin</span><span class="p">(</span><span class="o">++</span><span class="n">x</span><span class="p">,</span><span class="n">N</span><span class="p">);</span><span class="n">x</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span><span class="n">x</span><span class="o">+=</span><span class="n">x</span><span class="o">&amp;-</span><span class="n">x</span><span class="p">)</span> <span class="n">bit</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">+=</span><span class="n">v</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">ll</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
        <span class="n">ll</span> <span class="n">ret</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="n">ckmin</span><span class="p">(</span><span class="o">++</span><span class="n">x</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span><span class="n">x</span><span class="p">;</span><span class="n">x</span><span class="o">-=</span><span class="n">x</span><span class="o">&amp;-</span><span class="n">x</span><span class="p">)</span> <span class="n">ret</span><span class="o">+=</span><span class="n">bit</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
        <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">ll</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">-</span><span class="n">query</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">;</span>
<span class="n">ll</span> <span class="n">n</span><span class="p">,</span><span class="n">aa</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">ab</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">v1</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">v2</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">v3</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">v4</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">v5</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">val</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">ans</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">t2</span><span class="p">;</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">input</span><span class="p">(){</span>
    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="n">t</span><span class="p">;</span>
    <span class="n">fori</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">){</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;&gt;</span><span class="n">ab</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">solve</span><span class="p">(){</span> 
    <span class="n">input</span><span class="p">();</span>
    <span class="n">fori</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">){</span>
        <span class="n">xs</span><span class="p">.</span><span class="n">pb</span><span class="p">(</span><span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span> <span class="n">ys</span><span class="p">.</span><span class="n">pb</span><span class="p">(</span><span class="n">ab</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">all</span><span class="p">(</span><span class="n">xs</span><span class="p">));</span> <span class="n">sort</span><span class="p">(</span><span class="n">all</span><span class="p">(</span><span class="n">ys</span><span class="p">));</span>
    <span class="n">fori</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">){</span>
        <span class="n">p</span><span class="p">[</span><span class="n">lwb</span><span class="p">(</span><span class="n">all</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span><span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="n">begin</span><span class="p">(</span><span class="n">xs</span><span class="p">)]</span><span class="o">=</span><span class="n">lwb</span><span class="p">(</span><span class="n">all</span><span class="p">(</span><span class="n">ys</span><span class="p">),</span><span class="n">ab</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="n">begin</span><span class="p">(</span><span class="n">ys</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">fori</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="n">i</span><span class="p">){</span>
            <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">n</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">fori</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">){</span>

        <span class="n">v1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">b1</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="n">v2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">b1</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">inf</span><span class="p">);</span>
        <span class="n">v3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">b1</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">n</span><span class="p">);</span>

        <span class="n">b1</span><span class="p">.</span><span class="n">upd</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span>

        <span class="n">t2</span><span class="o">+=</span><span class="n">i</span><span class="o">-</span><span class="n">v1</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="c1">//guilty or innocent?</span>
    <span class="p">}</span>
    <span class="n">ford</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">0</span><span class="p">){</span>
        <span class="n">v2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">b2</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">n</span><span class="p">,</span><span class="n">inf</span><span class="p">);</span>
        <span class="n">v3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">b2</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="c1">//same as p[i]-n,p[i]</span>
        <span class="n">v4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">b2</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">n</span><span class="p">);</span>
        <span class="n">b2</span><span class="p">.</span><span class="n">upd</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">fori</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">){</span>
        <span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">v2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">v1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">v4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">v3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">val</span><span class="o">+</span><span class="n">n</span><span class="p">);</span> <span class="n">reverse</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">val</span><span class="o">+</span><span class="n">n</span><span class="p">);</span>
    <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="n">fori</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">){</span>
        <span class="n">t</span><span class="o">+=</span><span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">ckmax</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span><span class="n">t</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="n">ans</span><span class="o">=-</span><span class="n">ans</span><span class="p">;</span>
    <span class="n">ans</span><span class="o">+=</span><span class="n">t2</span><span class="p">;</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="o">&lt;&lt;</span><span class="n">nl</span><span class="p">;</span>

<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="cp">#ifdef LOCAL
</span>        <span class="n">fin</span><span class="p">(</span><span class="s">"a.txt"</span><span class="p">);</span>
    <span class="cp">#endif
</span>    <span class="kt">int</span> <span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="c1">//cin&gt;&gt;T;</span>
    <span class="n">foru</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">){</span>
        <span class="n">solve</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/**

*/</span>
    
</pre></td></tr></tbody></table></code></pre></figure>

</details>

<h2 id="conclusion">Conclusion</h2>
<p>From the results of the contest and mirror, the ratings for P4, P5, P6 are estimated at 2600r, 2500r, 4200r respectively. That feels about right. Looking back, I think I might have solved p4 or p5 during the contest back in 2021 if I spent more time on one of them and kept calm, but I definitely had no chance with p6. All problems were pretty good and interesting. Looking at the <a href="https://github.com/ac615223s5/programming-contest-resources/tree/main/other%20problems/cco21">official editorials</a>, my solution for p4 and p5 were intended, but my p6 solution was unlike any other submission on dmoj or ojuz. Speaking of loops, <a href="https://www.youtube.com/watch?v=KL5QIOgzkvQ">this</a> is a very good song.</p>

<p>Overall, this was a fun activity and it feels good to finally solve or resolve these problems from scratch.</p>

  </div>
  
  
  <a class="u-url" href="/2023/10/21/conquering-past-fears.html" hidden></a>
</article>
</main>
      <footer class="container1 w-64 flex flex-col gap-2.5 max-lg:w-full max-lg:flex-row flex-wrap max-lg:justify-evenly">
  <p class="feed-subscribe textColor">
    <a href="https://birdhome.stellar.afs.ovh/feed.xml">
      <svg class="inline w-5 h-5 fill-current">
        <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
      </svg> Subscribe
    </a>
  </p>
  <div>
    <h2 class="header2">Contact</h2>
    <ul class="contact-list mb-1">
      <li><a class="u-matrix link" href="https://matrix.to/#/@alnvyuitw34:matrix.org">@alnvyuitw34:matrix.org</a></li>
      <li><a class="u-email link" href="mailto:ppu7haxj@duck.com">ppu7haxj@duck.com</a></li>
    </ul>
    <div class="social-links"><div class="flex flex-wrap gap-2.5">
<a class="inline-block border border-solid border-gray-500 hover:border-black dark:hover:border-white p-2.5" rel="me" href="https://simplex.chat/contact#/?v=2-5&smp=smp%3A%2F%2FUkMFNAXLXeAAe0beCa4w6X_zp18PwxSaSjY17BKUGXQ%3D%40smp12.simplex.im%2FlMAI_ct62DZ8LSS5w-TtWG4G8pT1kVr_%23%2F%3Fv%3D1-2%26dh%3DMCowBQYDK2VuAyEAbhB6mjf8jT0GO3m5eqLEgRLZ7THEJRcnmXiKn-7aDHc%253D%26srv%3Die42b5weq7zdkghocs3mgxdjeuycheeqqmksntj57rmejagmg4eor5yd.onion" target="_blank" title="simplex">
  <svg class="w-5 h-5 align-text-bottom text-cyan-900 dark:text-amber-900 fill-current">
    <use xlink:href="/assets/minima-social-icons.svg#simplex"></use>
  </svg>
</a>
<a class="inline-block border border-solid border-gray-500 hover:border-black dark:hover:border-white p-2.5" rel="me" href="https://codeberg.org/nieve" target="_blank" title="codeberg">
  <svg class="w-5 h-5 align-text-bottom text-cyan-900 dark:text-amber-900 fill-current">
    <use xlink:href="/assets/minima-social-icons.svg#codeberg"></use>
  </svg>
</a>
<a class="inline-block border border-solid border-gray-500 hover:border-black dark:hover:border-white p-2.5" rel="me" href="https://github.com/ac615223s5" target="_blank" title="github">
  <svg class="w-5 h-5 align-text-bottom text-cyan-900 dark:text-amber-900 fill-current">
    <use xlink:href="/assets/minima-social-icons.svg#github"></use>
  </svg>
</a>
<a class="inline-block border border-solid border-gray-500 hover:border-black dark:hover:border-white p-2.5" rel="me" href="https://www.youtube.com/channel/UCm8GhQcqqMeWz67SiMgCwTQ" target="_blank" title="youtube">
  <svg class="w-5 h-5 align-text-bottom text-cyan-900 dark:text-amber-900 fill-current">
    <use xlink:href="/assets/minima-social-icons.svg#youtube"></use>
  </svg>
</a></div>
</div>
  </div>
  <div class="max-lg:w-full">
    <div class="max-lg:max-w-32 max-lg:mx-auto">
      <img src="" class="dark:hidden ">
<img src="/assets/images/decorations/christmas/christmas-balls-clip-art-7-2634342209.webp" class="hidden dark:block ">
    </div>
  </div>
  <div class="grow"></div>
  <div class="max-lg:w-full justify-center">
    <img src="/assets/images/decorations/christmas/pngtree-snowy-house-vector-png-image_12147036.png" class="dark:hidden ">
<img src="/assets/images/decorations/christmas/ab22dcc508d6b94604c05883e77d7bed.png" class="hidden dark:block ">
</div>
</footer>
    </div>
  </div>
  <div class="main-snow">
    <div class="initial-snow">
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
      <div class="snow">&#10052;</div>
    </div>
  </div>
</body>
<style>
  @media (prefers-color-scheme: light) {
    html {
      cursor: url(/assets/images/decorations/christmas/cookie-run-frost-queen-cookie-and-staff-pointer.png), auto;
      min-height: 100vh;
    }
    a{
      cursor: url(/assets/images/decorations/christmas/cookie-run-frost-queen-cookie-and-staff-cursor.png), auto;
    }
  }
    

	@keyframes snowfall {
		0% {
			transform: translate3d(var(--left-ini), 0, 0);
		}

		100% {
			transform: translate3d(var(--left-end), 110vh, 0);
		}
	}
	.main-snow {
		z-index: 100;
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		animation: main-loadup 1s forwards linear, main-loadup-bg 10s forwards linear;
		animation-delay: 7s, 8s;
		user-select: none;
		pointer-events: none;
		

		.initial-snow {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			overflow: hidden;
		}

		.initial-snow > * {
			font-size: 15px;
			color: white;
			position: absolute;
			top: -5vh;
		}

		.snow:nth-child(4n) {
			filter: blur(1px);
			font-size: 30px;
		}

		.snow:nth-child(12n) {
			filter: blur(2px);
			font-size: 40px;
			opacity: 0.7;
		}

		.snow:nth-child(20n) {
			filter: blur(5px);
			font-size: 50px;
			opacity: 0.5;
		}

		.snow:nth-child(1) {
			--size: 0.8vw;
			--left-ini: 0vw;
			--left-end: -1vw;
			left: 70vw;
			animation: snowfall 9s linear infinite;
			animation-delay: -1s;
		}

		.snow:nth-child(2) {
			--size: 0.2vw;
			--left-ini: -7vw;
			--left-end: 10vw;
			left: 65vw;
			animation: snowfall 15s linear infinite;
			animation-delay: -8s;
		}

		.snow:nth-child(3) {
			--size: 1vw;
			--left-ini: 6vw;
			--left-end: 6vw;
			left: 1vw;
			animation: snowfall 9s linear infinite;
			animation-delay: -7s;
		}

		.snow:nth-child(4) {
			--size: 0.2vw;
			--left-ini: -3vw;
			--left-end: 9vw;
			left: 88vw;
			animation: snowfall 14s linear infinite;
			animation-delay: -5s;
		}

		.snow:nth-child(5) {
			--size: 0.4vw;
			--left-ini: -2vw;
			--left-end: -9vw;
			left: 74vw;
			animation: snowfall 6s linear infinite;
			animation-delay: -4s;
		}

		.snow:nth-child(6) {
			--size: 0.2vw;
			--left-ini: 5vw;
			--left-end: 1vw;
			left: 35vw;
			animation: snowfall 6s linear infinite;
			animation-delay: -7s;
		}

		.snow:nth-child(7) {
			--size: 0.4vw;
			--left-ini: -2vw;
			--left-end: -1vw;
			left: 27vw;
			animation: snowfall 10s linear infinite;
			animation-delay: -8s;
		}

		.snow:nth-child(8) {
			--size: 1vw;
			--left-ini: -9vw;
			--left-end: -2vw;
			left: 69vw;
			animation: snowfall 8s linear infinite;
			animation-delay: -8s;
		}

		.snow:nth-child(9) {
			--size: 0.2vw;
			--left-ini: -1vw;
			--left-end: -5vw;
			left: 84vw;
			animation: snowfall 11s linear infinite;
			animation-delay: -6s;
		}

		.snow:nth-child(10) {
			--size: 0.2vw;
			--left-ini: 7vw;
			--left-end: -9vw;
			left: 82vw;
			animation: snowfall 10s linear infinite;
			animation-delay: -3s;
		}

		.snow:nth-child(11) {
			--size: 0.6vw;
			--left-ini: -2vw;
			--left-end: -1vw;
			left: 48vw;
			animation: snowfall 10s linear infinite;
			animation-delay: -1s;
		}

		.snow:nth-child(12) {
			--size: 0.2vw;
			--left-ini: 5vw;
			--left-end: 6vw;
			left: 39vw;
			animation: snowfall 15s linear infinite;
			animation-delay: -8s;
		}

		.snow:nth-child(13) {
			--size: 0.2vw;
			--left-ini: 6vw;
			--left-end: 5vw;
			left: 3vw;
			animation: snowfall 9s linear infinite;
			animation-delay: -8s;
		}

		.snow:nth-child(14) {
			--size: 0.8vw;
			--left-ini: -5vw;
			--left-end: -2vw;
			left: 49vw;
			animation: snowfall 11s linear infinite;
			animation-delay: -8s;
		}

		.snow:nth-child(15) {
			--size: 0.6vw;
			--left-ini: 10vw;
			--left-end: 4vw;
			left: 77vw;
			animation: snowfall 7s linear infinite;
			animation-delay: -4s;
		}

		.snow:nth-child(16) {
			--size: 0.8vw;
			--left-ini: -3vw;
			--left-end: 1vw;
			left: 86vw;
			animation: snowfall 14s linear infinite;
			animation-delay: -8s;
		}

		.snow:nth-child(17) {
			--size: 1vw;
			--left-ini: 6vw;
			--left-end: -7vw;
			left: 18vw;
			animation: snowfall 9s linear infinite;
			animation-delay: -6s;
		}

		.snow:nth-child(18) {
			--size: 1vw;
			--left-ini: -9vw;
			--left-end: 4vw;
			left: 64vw;
			animation: snowfall 13s linear infinite;
			animation-delay: -7s;
		}

		.snow:nth-child(19) {
			--size: 1vw;
			--left-ini: 2vw;
			--left-end: -7vw;
			left: 52vw;
			animation: snowfall 15s linear infinite;
			animation-delay: -9s;
		}

		.snow:nth-child(20) {
			--size: 0.4vw;
			--left-ini: 0vw;
			--left-end: 8vw;
			left: 5vw;
			animation: snowfall 8s linear infinite;
			animation-delay: -9s;
		}

		.snow:nth-child(21) {
			--size: 0.6vw;
			--left-ini: -9vw;
			--left-end: -2vw;
			left: 10vw;
			animation: snowfall 12s linear infinite;
			animation-delay: -3s;
		}

		.snow:nth-child(22) {
			--size: 0.8vw;
			--left-ini: -3vw;
			--left-end: -8vw;
			left: 54vw;
			animation: snowfall 11s linear infinite;
			animation-delay: -9s;
		}

		.snow:nth-child(23) {
			--size: 0.6vw;
			--left-ini: -7vw;
			--left-end: -8vw;
			left: 20vw;
			animation: snowfall 6s linear infinite;
			animation-delay: -3s;
		}

		.snow:nth-child(24) {
			--size: 0.4vw;
			--left-ini: 10vw;
			--left-end: -4vw;
			left: 68vw;
			animation: snowfall 10s linear infinite;
			animation-delay: -8s;
		}

		.snow:nth-child(25) {
			--size: 1vw;
			--left-ini: 3vw;
			--left-end: 5vw;
			left: 90vw;
			animation: snowfall 7s linear infinite;
			animation-delay: -9s;
		}

		.snow:nth-child(26) {
			--size: 1vw;
			--left-ini: -7vw;
			--left-end: 5vw;
			left: 71vw;
			animation: snowfall 13s linear infinite;
			animation-delay: -2s;
		}

		.snow:nth-child(27) {
			--size: 0.6vw;
			--left-ini: 9vw;
			--left-end: 4vw;
			left: 2vw;
			animation: snowfall 15s linear infinite;
			animation-delay: -5s;
		}

		.snow:nth-child(28) {
			--size: 1vw;
			--left-ini: -5vw;
			--left-end: 3vw;
			left: 23vw;
			animation: snowfall 12s linear infinite;
			animation-delay: -1s;
		}

		.snow:nth-child(29) {
			--size: 0.4vw;
			--left-ini: -2vw;
			--left-end: -1vw;
			left: 39vw;
			animation: snowfall 14s linear infinite;
			animation-delay: -9s;
		}

		.snow:nth-child(30) {
			--size: 0.6vw;
			--left-ini: -9vw;
			--left-end: -5vw;
			left: 76vw;
			animation: snowfall 10s linear infinite;
			animation-delay: -5s;
		}

		.snow:nth-child(31) {
			--size: 0.4vw;
			--left-ini: -5vw;
			--left-end: 3vw;
			left: 14vw;
			animation: snowfall 8s linear infinite;
			animation-delay: -5s;
		}

		.snow:nth-child(32) {
			--size: 0.2vw;
			--left-ini: 5vw;
			--left-end: -1vw;
			left: 86vw;
			animation: snowfall 10s linear infinite;
			animation-delay: -9s;
		}

		.snow:nth-child(33) {
			--size: 0.4vw;
			--left-ini: -3vw;
			--left-end: 10vw;
			left: 66vw;
			animation: snowfall 6s linear infinite;
			animation-delay: -6s;
		}

		.snow:nth-child(34) {
			--size: 1vw;
			--left-ini: -3vw;
			--left-end: 6vw;
			left: 75vw;
			animation: snowfall 14s linear infinite;
			animation-delay: -9s;
		}

		.snow:nth-child(35) {
			--size: 1vw;
			--left-ini: -6vw;
			--left-end: 7vw;
			left: 22vw;
			animation: snowfall 7s linear infinite;
			animation-delay: -5s;
		}

		.snow:nth-child(36) {
			--size: 1vw;
			--left-ini: 3vw;
			--left-end: 4vw;
			left: 10vw;
			animation: snowfall 11s linear infinite;
			animation-delay: -10s;
		}

		.snow:nth-child(37) {
			--size: 0.6vw;
			--left-ini: 2vw;
			--left-end: 10vw;
			left: 95vw;
			animation: snowfall 13s linear infinite;
			animation-delay: -6s;
		}

		.snow:nth-child(38) {
			--size: 0.8vw;
			--left-ini: 5vw;
			--left-end: 8vw;
			left: 34vw;
			animation: snowfall 9s linear infinite;
			animation-delay: -10s;
		}

		.snow:nth-child(39) {
			--size: 0.8vw;
			--left-ini: 4vw;
			--left-end: 0vw;
			left: 80vw;
			animation: snowfall 11s linear infinite;
			animation-delay: -2s;
		}

		.snow:nth-child(40) {
			--size: 0.8vw;
			--left-ini: 1vw;
			--left-end: -7vw;
			left: 45vw;
			animation: snowfall 11s linear infinite;
			animation-delay: -4s;
		}

		.snow:nth-child(41) {
			--size: 0.2vw;
			--left-ini: 9vw;
			--left-end: 10vw;
			left: 82vw;
			animation: snowfall 8s linear infinite;
			animation-delay: -2s;
		}

		.snow:nth-child(42) {
			--size: 1vw;
			--left-ini: 9vw;
			--left-end: -9vw;
			left: 22vw;
			animation: snowfall 10s linear infinite;
			animation-delay: -6s;
		}

		.snow:nth-child(43) {
			--size: 0.6vw;
			--left-ini: 5vw;
			--left-end: 8vw;
			left: 66vw;
			animation: snowfall 11s linear infinite;
			animation-delay: -1s;
		}

		.snow:nth-child(44) {
			--size: 0.6vw;
			--left-ini: -5vw;
			--left-end: -2vw;
			left: 75vw;
			animation: snowfall 12s linear infinite;
			animation-delay: -4s;
		}

		.snow:nth-child(45) {
			--size: 0.2vw;
			--left-ini: 0vw;
			--left-end: 3vw;
			left: 2vw;
			animation: snowfall 7s linear infinite;
			animation-delay: -5s;
		}

		.snow:nth-child(46) {
			--size: 0.2vw;
			--left-ini: 8vw;
			--left-end: -3vw;
			left: 94vw;
			animation: snowfall 8s linear infinite;
			animation-delay: -9s;
		}

		.snow:nth-child(47) {
			--size: 0.6vw;
			--left-ini: -6vw;
			--left-end: -9vw;
			left: 95vw;
			animation: snowfall 11s linear infinite;
			animation-delay: -4s;
		}

		.snow:nth-child(48) {
			--size: 0.2vw;
			--left-ini: -5vw;
			--left-end: 6vw;
			left: 34vw;
			animation: snowfall 10s linear infinite;
			animation-delay: -6s;
		}

		.snow:nth-child(49) {
			--size: 0.8vw;
			--left-ini: 4vw;
			--left-end: 8vw;
			left: 22vw;
			animation: snowfall 12s linear infinite;
			animation-delay: -10s;
		}

		.snow:nth-child(50) {
			--size: 0.2vw;
			--left-ini: -4vw;
			--left-end: 4vw;
			left: 100vw;
			animation: snowfall 14s linear infinite;
			animation-delay: -9s;
		}
	}

  @media (prefers-color-scheme: dark) {
    body {
      background: url(/assets/images/decorations/christmas/night_sky_snow-wallpaper-1920x1080.jpg);
      background-size: cover;
      background-attachment: fixed;
    }
  }
</style>
</html>
